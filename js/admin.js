(function(e){var t={init:function(){t.bindAddAction();t.bindDeleteAction()},bindAddAction:function(){e(document).on("click","#sca-newaction-submit",function(){var t=e(this).parent(".sca-new-action-container").find("#sca-type").val();if(t==""){e(".sca-new-action-container").find(".sca-type-container").addClass("error");return false}e(".sca-new-action-container").find(".sca-type-container").removeClass("error");var n={action:"sca_add_action",type:t,label:e(this).parent(".sca-new-action-container").find("#sca-type option:selected").text(),postId:e(this).parent(".sca-new-action-container").find("#sca-post-id").val(),dateDay:e(this).parent(".sca-new-action-container").find("#sca-date-day").val(),dateMonth:e(this).parent(".sca-new-action-container").find("#sca-date-month").val(),dateYear:e(this).parent(".sca-new-action-container").find("#sca-date-year").val(),dateHour:e(this).parent(".sca-new-action-container").find("#sca-date-hour").val(),dateMin:e(this).parent(".sca-new-action-container").find("#sca-date-min").val(),dateSec:e(this).parent(".sca-new-action-container").find("#sca-date-sec").val()};e.post(ajaxurl,n,function(t){var r=e.parseJSON(t);if(r.error=="1"){e(".sca-new-action-container").prepend('<div class="error"><p>'+r.msg+"</p></div>")}else{if(e(".sca-new-action-container").find("div.error").length)e(".sca-new-action-container").find("div.error").remove();if(e("#sca").length){if(e("#sca").find(".td-"+r.action_time).length){e("#sca").find(".td-"+r.action_time).append('<div class="sca-action"><a href="#" class="remove-action" data-postid="'+n.postId+'" data-time="'+r.action_time+'" data-action="'+n.type+'"></a>'+n.label+"</div>")}else{e("#sca").find("tbody").append('<tr><td class="left">'+r.action_date+'</td><td class="td-'+r.action_time+'"><div class="sca-action"><a href="#" class="remove-action" data-postid="'+n.postId+'" data-time="'+r.action_time+'" data-action="'+n.type+'"> </a> '+n.label+"</div></td></tr>")}}else{e(".sca-current-action-container").html('<table id="sca"><thead><tr><th class="left">'+r.ln_date+"</th><th>"+r.ln_action+'</th></tr></thead><tbody><tr><td class="left">'+r.action_date+'</td><td class="td-'+r.action_time+'"><div class="sca-action"><a href="#" class="remove-action" data-postid="'+n.postId+'" data-time="'+r.action_time+'" data-action="'+n.type+'"> </a> '+n.label+"</div></td></tr></tbody></table>")}}});return false})},bindDeleteAction:function(){e(document).on("click",".remove-action",function(){var t=e(this);var n={action:"sca_delete_action",type:e(this).data("action"),postId:e(this).data("postid"),time:e(this).data("time")};e.post(ajaxurl,n,function(n){t.parent().css("background","#f00");t.parent().delay(500).slideUp("normal",function(){var t=e(this).parent();e(this).remove();if(t.find(".sca-action").length==0){var n=t.parent("tr");n.remove();if(n.parent("tbody").children("tr").length==0){e(".sca-current-action-container").html("")}}})});return false})}};e(document).ready(function(e){t.init()})})(jQuery)