!function(a){var t={init:function(){t.bindAdditionalFormAction(),t.bindAddAction(),t.bindDeleteAction()},bindAdditionalFormAction:function(){a(document).on("change","#sca-type",function(){a(".sca-additional-form-data").html("");var e=a(this).val(),n=["","delete_term","add_term","add_meta","delete_meta","update_meta","change_title"];if(jQuery.inArray(e,n)>0){var i={action:"sca_load_additional_form_data",type:e,post_id:a("#post_ID").val()};a.post(ajaxurl,i,function(e){a(".sca-additional-form-data").html("<hr>"+e),t.bindAdditionalTaxonomyAction()})}return!1})},bindAdditionalTaxonomyAction:function(){a(document).on("change","#sca-term-taxonomy",function(){a(".sca-additional-taxonomy-data").html("");var t=a(this).val(),e={action:"sca_load_additional_form_data",type:"tax",tax:t};a.post(ajaxurl,e,function(t){a(".sca-additional-taxonomy-data").html("<hr>"+t)})})},bindAddAction:function(){a(document).on("click","#sca-newaction-submit",function(){var t=a(this),e=a(this).parent().parent().find("#sca-type").val();if(""==e)return a(".sca-new-action-container").find(".sca-type-container").addClass("error"),!1;a(".sca-new-action-container").find(".sca-type-container").removeClass("error");var n={action:"sca_add_action",type:e,label:a(this).parent().parent().find("#sca-type option:selected").text(),postId:a(this).parent().parent().find("#sca-post-id").val(),dateDay:a(this).parent().parent().find("#sca-date-day").val(),dateMonth:a(this).parent().parent().find("#sca-date-month").val(),dateYear:a(this).parent().parent().find("#sca-date-year").val(),dateHour:a(this).parent().parent().find("#sca-date-hour").val(),dateMin:a(this).parent().parent().find("#sca-date-min").val(),dateSec:a(this).parent().parent().find("#sca-date-sec").val()};return"add_term"==e||"delete_term"==e?(n.termTaxonomy=a("#sca-term-taxonomy").val(),n.termSlug=a("#sca-term-slug").val(),n.label+=" - "+sca_vars.label_taxonomy+": "+n.termTaxonomy+" "+sca_vars.label_term+": "+n.termSlug):"add_meta"==e||"update_meta"==e||"delete_meta"==e?(n.metaName=a("#sca-meta-name").val(),n.metaValue=a("#sca-meta-value").val(),n.label+=" - "+sca_vars.label_meta_name+": "+n.metaName+" "+sca_vars.label_meta_value+": "+n.metaValue):"change_title"==e&&(n.newTitle=a("#sca-new-title").val(),n.label=sca_vars.label_title+": "+n.newTitle),a.post(ajaxurl,n,function(e){var i=a.parseJSON(e);"1"==i.error?a(".sca-new-action-container").prepend('<div class="error"><p>'+i.msg+"</p></div>"):(t.parent().parent().find("div.error").length&&t.parent().parent().find("div.error").remove(),a("#sca").length?a("#sca").find(".td-"+i.action_time).length?a("#sca").find(".td-"+i.action_time).append('<div class="sca-action"><a href="#" class="remove-action" data-postid="'+n.postId+'" data-time="'+i.action_time+'" data-action="'+n.type+'">&nbsp;</a>&nbsp;'+n.label+"</div>"):a("#sca").find("tbody").append('<tr><td class="left">'+i.action_date+'</td><td class="td-'+i.action_time+'"><div class="sca-action"><a href="#" class="remove-action" data-postid="'+n.postId+'" data-time="'+i.action_time+'" data-action="'+n.type+'">&nbsp;</a>&nbsp;'+n.label+"</div></td></tr>"):a(".sca-current-action-container").html('<table id="sca"><thead><tr><th class="left">'+i.ln_date+"</th><th>"+i.ln_action+'</th></tr></thead><tbody><tr><td class="left">'+i.action_date+'</td><td class="td-'+i.action_time+'"><div class="sca-action"><a href="#" class="remove-action" data-postid="'+n.postId+'" data-time="'+i.action_time+'" data-action="'+n.type+'">&nbsp;</a>&nbsp;'+n.label+"</div></td></tr></tbody></table>"))}),!1})},bindDeleteAction:function(){a(document).on("click",".remove-action",function(){var t=a(this),e={action:"sca_delete_action",type:a(this).data("action"),postId:a(this).data("postid"),time:a(this).data("time")};return a.post(ajaxurl,e,function(e){t.parent().css("background","#d54e21"),t.parent().delay(500).slideUp("normal",function(){var t=a(this).parent(),e=t.parent("tr");e.css("display","none"),e.remove(),0==a("#sca").find("tr").length&&a(".sca-current-action-container").html("")})}),!1})}};a(document).ready(function(a){t.init()})}(jQuery);